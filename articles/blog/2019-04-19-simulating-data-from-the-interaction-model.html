<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulating data from the interaction model • dexter</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="Simulating data from the interaction model">
<meta property="og:description" content="dexter">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">dexter</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/dexter.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/DIF_vignette.html">Exploring Differential Items Functioning with Dexter</a>
    </li>
    <li>
      <a href="../../articles/Equating.html">Equating a Pass-Fail Score</a>
    </li>
    <li>
      <a href="../../articles/Plausible_Values.html">Plausible Values in Dexter</a>
    </li>
    <li>
      <a href="../../articles/profile-plots.html">How Members of Different Groups Obtain the Same Test Score: Profile Plots in Dexter</a>
    </li>
    <li>
      <a href="../../articles/Test_Individual_differences.html">One theta to rule them all: Test Individual Differences</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../articles/blog/index.html">Blog</a>
</li>
<li>
  <a href="../../articles/blog/about.html">About</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dexter-psychometrics/dexter" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="2019-04-19-simulating-data-from-the-interaction-model_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Simulating data from the interaction model</h1>
                        <h4 data-toc-skip class="author">Timo Bechger * Norman Verhelst * Ivailo Partchev</h4>
            
            <h4 data-toc-skip class="date">2019-04-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/dexter-psychometrics/dexter/blob/HEAD/vignettes/blog/2019-04-19-simulating-data-from-the-interaction-model.Rmd" class="external-link"><code>vignettes/blog/2019-04-19-simulating-data-from-the-interaction-model.Rmd</code></a></small>
      <div class="hidden name"><code>2019-04-19-simulating-data-from-the-interaction-model.Rmd</code></div>

    </div>

    
    
<p>I thought I had seen it all, dear readers. But now our first and second authors, who are in a student:professor relationship, want to have a programming contest among the two, and the problem is how to simulate data from Haberman’s interaction model (<span class="citation">Haberman (2007)</span>). Now, as a third author I cannot allow such extravagant behavior, can I. On the other hand, the problem is so interesting, and the two algorithms so fascinating, that I feel everyone should see them. So I publish them as Algorithm A and Algorithm B, along with some comments.</p>
<div class="section level2">
<h2 id="the-interaction-model">The interaction model<a class="anchor" aria-label="anchor" href="#the-interaction-model"></a>
</h2>
<p>While not even mentioned at the career award session dedicated to Shelby Haberman at NCME 2019, his interaction model (IM) must be one of the brightest, practically most salient ideas in psychometrics since 2000. It plays a strategic role in <strong>dexter</strong>, and we have posted several times about it and will continue to do so in the future. The IM can be represented in several ways, each of them highlighting different aspects of interest and applicability:</p>
<ul>
<li>as a generalization of the Rasch model that relaxes conditional independence while retaining sufficient statistics and the immediate connection to the observable</li>
<li>as an exponential family model that reproduces all aspects of the data relevant to classical test theory: i.e., the score distribution, the item difficulties, and the item-total correlations</li>
<li>as a Rasch model where item difficulty depends both on the item and on the total score.</li>
</ul>
<p>In other posts, we have already commented on the usefulness of these properties in various practical situations. When devising a strategy to simulate from the model, the third aspect seems the most promising.</p>
<p>The interaction model can be expressed as a generalization of the Rasch model where item difficulty is a linear function of the test-score: <span class="math display">\[\begin{align*}
P(\mathbf{X}=\mathbf{x}|\theta) 
&amp;\propto \exp(\theta r - \sum_i \delta_{ri} x_i)
\end{align*}\]</span> where <span class="math inline">\(\delta_{ri}=\delta_i-r\sigma_i\)</span> for any possible sum score <span class="math inline">\(r\)</span>.</p>
<p>As an illustration, let us simulate data from an interaction model and use these to estimate a Rasch model separately for persons with the same test score (provided there are enough of them):</p>
<img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-1" alt="plot of chunk unnamed-chunk-1" style="display: block; margin: auto;"><p class="caption">
plot of chunk unnamed-chunk-1
</p>
<p>The dots are the estimated Rasch item parameters for each score-group, the green line represents the model from which we simulated, and the gray curve is obtained when we fit an interaction model to the simulated data. Two things are worth noting. First, we need very large samples to make such plots. Second, when we do have large samples, we often observe a linear relationship between item difficulty and test score. For some reason, the interaction model seems to describe educational data quite well.</p>
<p>Anyway. We have simulated data from the interaction model but the original question was how to do exactly that. Simulating from the Rasch model is fairly trivial. Given a vector of item difficulties, delta, and a sample from the ability distribution, theta, the R function is a one-liner:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simRasch</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span>, <span class="va">delta</span><span class="op">)</span>
<span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">rlogis</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">delta</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="op">(</span><span class="va">theta</span><span class="op">-</span><span class="va">delta</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>To simulate responses from the interaction model, we can apply this at each distinct test score <span class="math inline">\(r\)</span> with score-specific item difficulties <span class="math inline">\(\delta_{ri}=\delta_i-r\sigma_i\)</span> rather than simply <span class="math inline">\(\delta_i\)</span>. But this is not all, as the responses conditional on a given test-score are not independent. The two algorithms presented here differ in how they tackle this dependency: one samples item parameters directly while the other one relies on a simple rejection algorithm.</p>
</div>
<div class="section level2">
<h2 id="algorithm-a-rejection-sampling">Algorithm A: rejection sampling<a class="anchor" aria-label="anchor" href="#algorithm-a-rejection-sampling"></a>
</h2>
<p>As mentioned above, the interaction model preserves the item difficulties, the item-total correlations, and the score distribution, so we enter the simulation with three inputs: <code>delta</code>, <code>sigma</code>, and <code>scoretab</code>. We sample from the discrete score distribution, <code>scoretab</code>, and, since the interaction model maps sum scores to ability estimates, we attach those from a look-up table easily produced with <strong>dexter</strong>. (For those who prefer to sample from the ability distribution, we will show in the Appendix how to derive the score distribution from that.)</p>
<p>We then go over all simulated ‘examinees’ and we simulate responses from the Rasch model, with <code>theta</code> and item difficulties both matching the person’s score, until the simulated sum score equals the true one. For zero and perfect scores, we simply take vectors of 0 or 1. In R:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim_IM</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">delta</span>, <span class="va">sigma</span>, <span class="va">scoretab</span><span class="op">)</span>
<span class="op">{</span>
  <span class="va">nI</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">delta</span><span class="op">)</span>
  <span class="va">nP</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">scoretab</span><span class="op">)</span>
  <span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nI</span><span class="op">)</span>
  <span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nP</span>, <span class="va">nI</span><span class="op">)</span>
  <span class="co"># nP samples from the score distribution:</span>
  <span class="va">s</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">nI</span>, <span class="va">nP</span>, replace<span class="op">=</span><span class="cn">TRUE</span>, prob<span class="op">=</span><span class="va">scoretab</span><span class="op">)</span>
  <span class="co"># attach the MLE estimates of theta:</span>
  <span class="va">abl</span> <span class="op">=</span> <span class="fu">IM_mle</span><span class="op">(</span><span class="va">delta</span>,<span class="va">sigma</span><span class="op">)</span>

  <span class="kw">for</span> <span class="op">(</span><span class="va">p</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nP</span><span class="op">)</span>
  <span class="op">{</span>
    <span class="co"># compute item difficulties at score s[p]:</span>
    <span class="va">delta_s</span> <span class="op">=</span> <span class="va">delta</span> <span class="op">-</span> <span class="va">s</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">*</span><span class="va">sigma</span>
    <span class="kw">repeat</span><span class="op">{</span>
        <span class="va">y</span> <span class="op">=</span> <span class="fu">simRasch</span><span class="op">(</span>theta<span class="op">=</span><span class="va">abl</span><span class="op">[</span><span class="va">s</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span>, delta<span class="op">=</span><span class="va">delta_s</span><span class="op">)</span>
        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">==</span><span class="va">s</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">)</span> <span class="kw">break</span>
    <span class="op">}</span>
    <span class="va">x</span><span class="op">[</span><span class="va">p</span>,<span class="op">]</span> <span class="op">=</span> <span class="va">y</span>
  <span class="op">}</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>The ability that matches a person’s score is the maximum likelihood estimate (MLE); i.e., the ability for which the expected score is equal to the observed one. In fact, any theta would do, eventually, but then we would have to wait much longer until the sum of the simulated response pattern matches the target sum score. For the aficionados, our <strong>makeMLE</strong> function is provided in the Appendix.</p>
</div>
<div class="section level2">
<h2 id="algorithm-b-sampling-without-replacement">Algorithm B: sampling without replacement<a class="anchor" aria-label="anchor" href="#algorithm-b-sampling-without-replacement"></a>
</h2>
<p>The dependence between responses conditional on the sum score can be approached by simulating them sequentially and adjusting the probability after each draw, much as we would take samples from an urn without replacement. An algorithm can be constructed based on the observation that at any sum score <span class="math inline">\(r\)</span>, the probability that item <span class="math inline">\(i\)</span> is answered correctly can be computed as <span class="math display">\[P(X_i=1|r) = \frac{b_{ri}\gamma_{r-1}(\mathbf{b}_{r}[-i])}{\gamma_{r}(\mathbf{b}_{r})}\]</span> where <span class="math inline">\(b_{ri} = \exp(-\delta_{ri}) = \exp[-(\delta_i-\sigma_ir )]\)</span>, <span class="math inline">\(\mathbf{b}_{r}[-i]\)</span> is the vector of item parameters without the <span class="math inline">\(i\)</span>th entry, and <span class="math inline">\(\gamma_{s}(\mathbf{b})\)</span> the <em>elementary symmetric function</em> of <span class="math inline">\(\mathbf{b}\)</span> of order <span class="math inline">\(s\)</span>. Note the use of an R-like notation to express dropping the <span class="math inline">\(i\)</span>-th element.</p>
<p>This may be a bit subtle, so we illustrate what happens with a small example. Suppose that we have a test of three items. If the test score is 0 or 3, there is nothing to do because there is only one possible response pattern in each case. Suppose <span class="math inline">\(x_+=2\)</span>, and let us start by simulating the response to the third item. This is a Bernoulli experiment with the probability of success given by <span class="math display">\[
P(X_3=1|X_+ = 2, \boldsymbol{\delta}_2) = \frac{b_{23}(b_{21}+b_{22})}{b_{21}b_{22}+b_{21}b_{23}+b_{22}b_{23}}
\]</span> with the ESF written out. If the experiment fails, then we are done because, with <span class="math inline">\(x_+=2\)</span>, the responses to the first two items must be correct. If it succeeds, we are left with a test of two items and a sum score of 1. To simulate the response to item 2, we perform another Bernoulli experiment with a probability of success <span class="math display">\[
P(X_2=1|X_+ = 1, \boldsymbol{\delta}_2) = \frac{b_{22}b_{21}}{b_{21}+b_{22}}.
\]</span> Regardless of the outcome, the answer to the first item is now also determined because the sum score must be 2. The case of <span class="math inline">\(x_+=1\)</span> is handled in a similar fashion, and don’t forget to replace <span class="math inline">\(\boldsymbol{\delta}_2\)</span> with <span class="math inline">\(\boldsymbol{\delta}_1\)</span> because we are simulating from the interaction model, remember?</p>
<p>The computational burden with Algorithm B is in the calculation of the elementary symmetric functions. What is minimally required is a <span class="math inline">\(n+1\)</span> by <span class="math inline">\(n\)</span> matrix <span class="math inline">\(\mathbf{G}_{x_+}\)</span> whose columns contain the elementary functions for <span class="math inline">\(\mathbf{b}_{x_+}[1], \mathbf{b}_{x_+}[1:2], \dots, \mathbf{b}_{x_+}[1:n]\)</span>. Since we need <span class="math inline">\(\mathbf{G}_{x_+}\)</span> for all possible test-scores <span class="math inline">\(x_+\)</span>, we make a three way array <span class="math inline">\(\mathbf{G}\)</span>: test-scores by number of test-scores by number of items. The entries of <span class="math inline">\(\mathbf{G}\)</span> are: <span class="math display">\[
g_{rsi} =
\left\{
\begin{array}{cl}
\gamma_{s}(\mathbf{b}_{r}[1:i]) &amp; \text{if $s\leq i$}\\
0 &amp; \text{if $s&gt;i$}
\end{array}
\right.
\]</span></p>
<p>where the first two indices <span class="math inline">\(r\)</span> and <span class="math inline">\(s\)</span> run from zero to <span class="math inline">\(n\)</span>, and the third index <span class="math inline">\(i\)</span> runs from <span class="math inline">\(1\)</span> to <span class="math inline">\(n\)</span>. The elementary symmetric functions are calculated using the sum-algorithm. Here is the necessary code in R:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">elsymRM</span> <span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">b</span><span class="op">)</span>
<span class="op">{</span>
  <span class="va">n</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span>
  <span class="va">g</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>
  <span class="va">g</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fl">1</span>; <span class="va">g</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="va">b</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  
  <span class="kw">if</span> <span class="op">(</span><span class="va">n</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span>
  <span class="op">{</span>
    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">n</span><span class="op">)</span>
    <span class="op">{</span>
      <span class="kw">for</span> <span class="op">(</span><span class="va">s</span> <span class="kw">in</span> <span class="op">(</span><span class="va">j</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="va">g</span><span class="op">[</span><span class="va">s</span><span class="op">]</span><span class="op">=</span><span class="va">g</span><span class="op">[</span><span class="va">s</span><span class="op">]</span><span class="op">+</span><span class="va">g</span><span class="op">[</span><span class="va">s</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">b</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>
    <span class="op">}</span>
  <span class="op">}</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>
<span class="op">}</span>
 
<span class="va">makeG</span> <span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">b_s</span><span class="op">)</span>
<span class="op">{</span>
  <span class="va">nI</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">b_s</span><span class="op">)</span>   
  <span class="va">G</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">nI</span><span class="op">+</span><span class="fl">1</span>,<span class="va">nI</span><span class="op">+</span><span class="fl">1</span>,<span class="va">nI</span><span class="op">)</span><span class="op">)</span> 
  <span class="kw">for</span> <span class="op">(</span><span class="va">s</span> <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="va">nI</span><span class="op">)</span>
  <span class="op">{</span>
    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">nI</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>
    <span class="op">{</span>
      <span class="va">G</span><span class="op">[</span><span class="va">s</span><span class="op">+</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,<span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu">elsymRM</span><span class="op">(</span><span class="va">b_s</span><span class="op">[</span><span class="va">s</span><span class="op">+</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
    <span class="op">}</span>
  <span class="op">}</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>It is now straightforward to implement the simulation algorithm itself:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim_IMB</span> <span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">delta</span>, <span class="va">sigma</span>, <span class="va">scoretab</span><span class="op">)</span>
<span class="op">{</span>
  <span class="va">nI</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">delta</span><span class="op">)</span>
  <span class="va">nP</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">scoretab</span><span class="op">)</span>
  <span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nP</span>, <span class="va">nI</span><span class="op">)</span>
  <span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">nI</span>, <span class="va">nP</span>, replace<span class="op">=</span><span class="cn">TRUE</span>, prob<span class="op">=</span><span class="va">scoretab</span><span class="op">)</span>
  <span class="va">b_r</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nI</span><span class="op">+</span><span class="fl">1</span>, <span class="va">nI</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">s</span> <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="va">nI</span><span class="op">)</span> <span class="va">b_r</span><span class="op">[</span><span class="va">s</span><span class="op">+</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="va">delta</span> <span class="op">-</span> <span class="va">s</span><span class="op">*</span><span class="va">sigma</span><span class="op">)</span><span class="op">)</span>
  <span class="co"># so far, as in Algorithm A, but now compute the </span>
  <span class="co"># matrix of elementary symmetric functions rather</span>
  <span class="co"># than the MLE of ability at each sum score</span>
  <span class="va">G</span> <span class="op">=</span> <span class="fu">makeG</span><span class="op">(</span><span class="va">b_r</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">p</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nP</span><span class="op">)</span>
  <span class="op">{</span>
    <span class="va">s</span> <span class="op">=</span> <span class="va">r</span><span class="op">[</span><span class="va">p</span><span class="op">]</span>
    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">nI</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>
    <span class="op">{</span>
      <span class="kw">if</span> <span class="op">(</span><span class="va">s</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="kw">break</span>
      <span class="kw">if</span> <span class="op">(</span><span class="va">s</span> <span class="op">==</span> <span class="va">i</span><span class="op">)</span>
      <span class="op">{</span>
        <span class="va">x</span><span class="op">[</span><span class="va">p</span>, <span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span>
        <span class="kw">break</span>
      <span class="op">}</span>
      <span class="va">pi_s</span> <span class="op">=</span> <span class="op">(</span><span class="va">b_r</span><span class="op">[</span><span class="va">r</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span>, <span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="va">G</span><span class="op">[</span><span class="va">r</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span>, <span class="va">s</span>, <span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="va">G</span><span class="op">[</span><span class="va">r</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span>, <span class="va">s</span><span class="op">+</span><span class="fl">1</span>, <span class="va">i</span><span class="op">]</span>
      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="va">pi_s</span><span class="op">)</span>
      <span class="op">{</span>
        <span class="va">x</span><span class="op">[</span><span class="va">p</span>, <span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span>
        <span class="va">s</span> <span class="op">=</span> <span class="va">s</span> <span class="op">-</span> <span class="fl">1</span>
      <span class="op">}</span>
    <span class="op">}</span>
  <span class="op">}</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Note that both <span class="math inline">\(\mathbf{b}\)</span> and <span class="math inline">\(\mathbf{G}\)</span> are pre-calculated outside of the loop over persons. Note further that we break as soon as we know all remaining responses.</p>
</div>
<div class="section level2">
<h2 id="comparing-the-two-algorithms">Comparing the two algorithms<a class="anchor" aria-label="anchor" href="#comparing-the-two-algorithms"></a>
</h2>
<div class="section level3">
<h3 id="speed">Speed<a class="anchor" aria-label="anchor" href="#speed"></a>
</h3>
<p>Both algorithms are fast enough for practical purposes even though they are in plain R, not your fastest language. Additional speed can be gained by rewriting the critical parts in FORTRAN or C. Algorithm A turns out to be faster, which is worth mentioning because the idea of rejection sampling is inherently associated with some waste.</p>
<img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-5" alt="plot of chunk unnamed-chunk-5" style="display: block; margin: auto;"><p class="caption">
plot of chunk unnamed-chunk-5
</p>
</div>
<div class="section level3">
<h3 id="stability">Stability<a class="anchor" aria-label="anchor" href="#stability"></a>
</h3>
<p>Note that the plots do not show times for more than a hundred items. Algorithm B depends on computing the <a href="https://en.wikipedia.org/wiki/Elementary_symmetric_polynomial" class="external-link">elementary symmetric functions</a>, the gentlest monster you have ever encountered, but still a monster in your backyard. We have used the sum-algorithm, which is perfectly reliable for tests of reasonable length, say up to 100 items. In the interaction model the item difficulties can become large quite rapidly such that, for longer tests, it may be compromised by numeric overflow. For example, with <span class="math inline">\(150\)</span> items and <span class="math inline">\(x_+\)</span> equal to <span class="math inline">\(145\)</span>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">delta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">150</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">1.5</span><span class="op">)</span>
<span class="va">sigma</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">150</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span>
<span class="va">s</span> <span class="op">=</span> <span class="fl">145</span>
<span class="va">b_r</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="va">delta</span><span class="op">-</span><span class="va">s</span><span class="op">*</span><span class="va">sigma</span><span class="op">)</span><span class="op">)</span>
<span class="va">esf</span> <span class="op">=</span> <span class="fu">elsymRM</span><span class="op">(</span><span class="va">b_r</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">esf</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] Inf</span></code></pre>
<p>The ESF are indispensable when dealing with test data and psychometric models, they are ubiquitous in <strong>dexter</strong>, but programming them for production purposes requires extra care. Our second author has developed a special FORTRAN library for dealing with very large numbers, somewhat similar to R package Brobdingnag (<span class="citation">Hankin (2007)</span>) but better and, as it happens much too often with this author, unpublished. We will revisit the problem in the future.</p>
</div>
<div class="section level3">
<h3 id="official-implementation">Official implementation<a class="anchor" aria-label="anchor" href="#official-implementation"></a>
</h3>
<p>Dexter has, since the writing of this blog, acquired a function <code>r_score_IM</code> to simulate item scores from the interaction model. This is a slightly faster implementation of algorithm A, which also works for polytomous items.</p>
</div>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<div class="section level3">
<h3 id="simulate-score-distribution-from-a-continuous-distribution-of-ability">Simulate score distribution from a continuous distribution of ability<a class="anchor" aria-label="anchor" href="#simulate-score-distribution-from-a-continuous-distribution-of-ability"></a>
</h3>
<p>In both algorithms, we sampled “persons” from a discrete distribution of sum scores. This may seem unusual and, more importantly: where do we get that? Readers may be more accustomed to sampling ability values from a continuous distribution, with the normal distribution as a particularly popular choice. Although there is no compelling reason to believe that abilities must be normally distributed, it is not implausible, and everyone knows the <code>rnorm</code> function in R (<span class="citation">R Development Core Team (2005)</span>).</p>
<p>To get samples from a discrete distribution of sum scores starting with samples from a continuous distribution and a set of item parameters, we may consider that, since <span class="math display">\[
P(x_+) = \int P(x_+|\theta) f(\theta) d\theta
\]</span> we can sample <span class="math inline">\(\theta\)</span> from <span class="math inline">\(f(\theta)\)</span> and subsequently sample <span class="math inline">\(x_+\)</span> from <span class="math inline">\(P(x_+|\theta)\)</span>.</p>
<p>What is <span class="math inline">\(P(x_+|\theta)\)</span>? We find it if we write <span class="math display">\[
P(\mathbf{x}|\theta) = \frac{e^{x_+\theta}\prod_i b^{x_i}_{x_+i}}{\sum_s e^{s\theta} \gamma_s(\mathbf{b}_s)}
=\frac{\prod_i b^{x_i}_{x_+i}}{\gamma_{x_+}(\mathbf{b}_{x_+})} \frac{e^{x_+\theta}\gamma_{x_+}(\mathbf{b}_{x_+})}{\sum_s e^{s\theta} \gamma_s(\mathbf{b}_s)} = P(\mathbf{x}|x_+)P(x_+|\theta)
\]</span> Thus, <span class="math display">\[
P(x_+|\theta) \propto e^{x_+\theta}\gamma_{x_+}(\mathbf{b}_{x_+})
\]</span> Conveniently, we have already computed the elementary symmetric functions and saved them in the matrix, <span class="math inline">\(\mathbf{G}\)</span>, so:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sample_scores</span> <span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">theta</span>, <span class="va">G</span><span class="op">)</span>
<span class="op">{</span>
  <span class="va">nI</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
  <span class="va">nP</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>
  <span class="va">scores</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nP</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">p</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nP</span><span class="op">)</span>
  <span class="op">{</span>
    <span class="va">prop</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">nI</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>
    <span class="kw">for</span> <span class="op">(</span><span class="va">s</span> <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="va">nI</span><span class="op">)</span>
    <span class="op">{</span>
      <span class="va">prop</span><span class="op">[</span><span class="va">s</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="va">p</span><span class="op">]</span><span class="op">*</span><span class="va">s</span><span class="op">)</span> <span class="op">*</span> <span class="va">G</span><span class="op">[</span><span class="va">s</span><span class="op">+</span><span class="fl">1</span>, <span class="va">s</span><span class="op">+</span><span class="fl">1</span>, <span class="va">nI</span><span class="op">]</span>
    <span class="op">}</span>
    <span class="va">scores</span><span class="op">[</span><span class="va">p</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">nI</span>, <span class="fl">1</span>, prob<span class="op">=</span><span class="va">prop</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">scores</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mle">MLE<a class="anchor" aria-label="anchor" href="#mle"></a>
</h3>
<p>How to find the MLE of ability under a Rasch model is explained in our blog entry about the Warm estimator. Here we use the <code><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot()</a></code> function to find the root.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># MLE ability estimate for dichotomous interaction model</span>
<span class="va">IM_mle</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">delta</span>, <span class="va">sigma</span><span class="op">)</span>
<span class="op">{</span>
  <span class="va">scores</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">delta</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>
  
  <span class="va">Es_x</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span>
  <span class="op">{</span>
    <span class="va">delta</span> <span class="op">=</span> <span class="va">delta</span> <span class="op">-</span> <span class="va">s</span><span class="op">*</span><span class="va">sigma</span>
    <span class="kw">function</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span> 
    <span class="op">{</span>
      <span class="va">Pi</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">delta</span> <span class="op">-</span> <span class="va">theta</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>
      <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Pi</span><span class="op">)</span> <span class="op">-</span> <span class="va">s</span>
    <span class="op">}</span>
  <span class="op">}</span>

  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">scores</span>, <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">uniroot</a></span><span class="op">(</span><span class="fu">Es_x</span><span class="op">(</span><span class="va">s</span><span class="op">)</span>, interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>,<span class="fl">20</span><span class="op">)</span>,extendInt<span class="op">=</span><span class="st">'yes'</span><span class="op">)</span><span class="op">$</span><span class="va">root</span><span class="op">)</span>,
    <span class="cn">Inf</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-IM">
<p>Haberman, Shelby J. 2007. “The Interaction Model.” In <em>Multivariate and Mixture Distribution Rasch Models: Extensions and Applications</em>, edited by M. von Davier and C. H. Carstensen, 201–16. New York: Springer.</p>
</div>
<div id="ref-RKSHankin07p15">
<p>Hankin, RKS. 2007. “Very Large Numbers in R: Introducing Package Brobdingnag.” <em>R News</em> 7 (3): 15—16.</p>
</div>
<div id="ref-R">
<p>R Development Core Team. 2005. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org" class="external-link">https://www.R-project.org</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Gunter Maris, Timo Bechger, Jesse Koops, Ivailo Partchev.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
