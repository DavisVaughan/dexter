<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Classical Test Theory with IRT • dexter</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<meta property="og:title" content="Classical Test Theory with IRT">
<meta property="og:description" content="dexter">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">dexter</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/dexter.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/DIF_vignette.html">Exploring Differential Items Functioning with Dexter</a>
    </li>
    <li>
      <a href="../../articles/Equating.html">Equating a Pass-Fail Score</a>
    </li>
    <li>
      <a href="../../articles/Plausible_Values.html">Plausible Values in Dexter</a>
    </li>
    <li>
      <a href="../../articles/profile-plots.html">How Members of Different Groups Obtain the Same Test Score: Profile Plots in Dexter</a>
    </li>
    <li>
      <a href="../../articles/Test_Individual_differences.html">One theta to rule them all: Test Individual Differences</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../articles/blog/index.html">Blog</a>
</li>
<li>
  <a href="../../articles/blog/about.html">About</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dexter-psychometrics/dexter" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="2022-01-31-CTT_IRT_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Classical Test Theory with IRT</h1>
                        <h4 data-toc-skip class="author">Timo Bechger and Jesse Koops</h4>
            
            <h4 data-toc-skip class="date">2022-01-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/dexter-psychometrics/dexter/blob/HEAD/vignettes/blog/2022-01-31-CTT_IRT.Rmd" class="external-link"><code>vignettes/blog/2022-01-31-CTT_IRT.Rmd</code></a></small>
      <div class="hidden name"><code>2022-01-31-CTT_IRT.Rmd</code></div>

    </div>

    
    
<p>Item response theory (IRT) and classical test theory (CTT) can be combined. To this effect, we can use <strong>theta functions</strong> in dexter:</p>
<ul>
<li>
<strong>expected_score</strong>: The expected score given theta.</li>
<li>
<strong>information</strong>: The Fisher information about theta in the test score.</li>
<li>
<strong>p_score</strong>: The distribution of test scores given theta.</li>
</ul>
<p>where theta, i.e., <span class="math inline">\(\theta\)</span>, represents student ability. The aim of this blog is to illustrate the use of these functions but we commence with a (very) brief overview of CTT.</p>
<div class="section level2">
<h2 id="classical-test-theory">Classical test theory<a class="anchor" aria-label="anchor" href="#classical-test-theory"></a>
</h2>
<p>The test score is assumed to be discrete random variable <span class="math inline">\(X_+\)</span> where the randomness is due to measurement error. The expected score of a test taker with ability <span class="math inline">\(\theta\)</span>, <span class="math inline">\(\mathcal{E}[X_+|\theta]\)</span> is called the <em>true score</em>. It is the average score over (hypothetical) repeated testing of the same individual or the average score of people with the same ability.</p>
<p>The true score is a function of ability and, in IRT parlance, would be called the <strong>test characteristic function (TCF)</strong>. Obviously, the TCF can not be observed but if we assume a Rasch model, we can draw its curve using the function <strong>expected_score</strong> – the test score being the number of correct answers.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">parms</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>item_id<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, item_score<span class="op">=</span><span class="fl">1</span>, beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span><span class="op">)</span>
<span class="va">Exp_sc</span> <span class="op">=</span> <span class="fu"><a href="../../reference/information.html">expected_score</a></span><span class="op">(</span><span class="va">parms</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Exp_sc</span>, from<span class="op">=</span><span class="op">-</span><span class="fl">5</span>,to<span class="op">=</span><span class="fl">5</span>, xlab<span class="op">=</span><span class="st">"ability"</span>, ylab<span class="op">=</span><span class="st">"Exp. score"</span><span class="op">)</span></code></pre></div>
<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-1" alt="plot of chunk unnamed-chunk-1" style="display: block; margin: auto;"></p>
<p>The observed scores vary around their average due to <strong>measurement error</strong>, formally defined as deviations around the true score; <span class="math inline">\(x_+ - \mathcal{E}[X_+|\theta]\)</span>. As we can always write <span class="math inline">\(x_+ = \mathcal{E}[X_+|\theta] + \left(x_+ - \mathcal{E}[X_+|\theta]\right)\)</span>, we now find the famous equation: <span class="math display">\[
\text{observed score} = \text{true score} + \text{measurement error}
\]</span> which is merely a tautology, equivalent to a random-effects ANOVA model.</p>
<p>The amount of measurement error at a given level of ability can be captured by the <strong>conditional error variance (CEV)</strong>: <span class="math display">\[\begin{equation}
Var(X_+|\theta)=\mathcal{E}[\left(X_+ - \mathcal{E}[X_+|\theta] \right)^2|\theta]
\end{equation}\]</span> Like the true score, the CEV is a function of ability. Here is a plot.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Cond.error.variance</span> <span class="op">=</span> <span class="fu"><a href="../../reference/information.html">information</a></span><span class="op">(</span><span class="va">parms</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="va">Cond.error.variance</span>, from<span class="op">=</span><span class="op">-</span><span class="fl">5</span>,to<span class="op">=</span><span class="fl">5</span>, col<span class="op">=</span><span class="st">"blue"</span>, xlab<span class="op">=</span><span class="st">"ability"</span><span class="op">)</span></code></pre></div>
<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-2" alt="plot of chunk unnamed-chunk-2" style="display: block; margin: auto;"></p>
<p>Note that the CEV coincides with <a href="https://dexterities.netlify.com/2018/11/05/test-and-item-information-functions-in-dexter/" class="external-link"><strong>test information</strong></a> which is counter-intuitive as “error” sounds negative and “information” positive. Moreover, it is not true in general - only in exponential family IRT models. We will clarify this in a future blog where we explain the difference between estimating a true score or an ability.</p>
<p>What happens in a population of test-takers? Using the <a href="https://en.wikipedia.org/wiki/Law_of_total_expectation" class="external-link">law of total expectation</a>, we find that, in a population of test-takers, the average of the true scores <span class="math inline">\(\mathcal{E}[\mathcal{E}[X_+|\theta]] = \mathcal{E}[X_+]\)</span> is just the average of the scores – measurement errors average to zero. The variance of the test score is the sum of true score variance and error variance. Specifically, from the <a href="https://en.wikipedia.org/wiki/Law_of_total_variance" class="external-link">law of total variance</a> it follows that: <span class="math display">\[
Var(X_+)=Var(\mathcal{E}[X_+|\theta])+\mathcal{E}[Var(X_+|\theta)]
\]</span> where <span class="math inline">\(Var(\mathcal{E}[X_+|\theta])\)</span> is the true-score variance and <span class="math display">\[\begin{align*}
 \mathcal{E}[Var(X_+|\theta)] &amp; \equiv \mathcal{E}(\mathcal{E}[(X_+-\mathcal{E}[X_+|\theta])^{2}|\theta])  \\
 &amp;=\mathcal{E}[(X_+-\mathcal{E}[X_+|\theta])^{2}]
\end{align*}\]</span> is indeed the variance of the measurement errors – sometimes called <strong>the average error variance</strong>. In the population of test takers, measurement errors and true scores are uncorrelated but not necessarily independent. For one thing, we expect measurement error to be smaller for test takers whose true scores lie on the upper or lower end of the score range - simply because it cannot be lower or higher.</p>
<p>Last, but not least, the proportion true-score variance in the population is the <strong>reliability</strong>. That is, <span class="math display">\[
\operatorname{rel}(X_+)  
  \equiv\frac{\operatorname{Var}(\mathcal{E}[X_+|\theta])}{\operatorname{Var}(X_+)}
=1-\frac{\mathcal{E}[\operatorname{Var}(X_+|\theta)]}{\operatorname{Var}(\mathcal{E}[X_+|\theta])+\mathcal{E
}[Var(X_+|\theta)]}
\]</span> defined if <span class="math inline">\(\operatorname{Var}(X_+)&gt;0\)</span>. Note that, since <span class="math inline">\(Var(X_+) \geq Var(\mathcal{E}[X_+|\theta])\)</span>, <span class="math inline">\(0\leq \operatorname{rel}(X_+)\leq 1\)</span>. Reliability is the correlation between two administrations of the same test to samples from the same population (see <span class="citation">Bechger et al. (2003)</span>) and is widely used as a measure of consistency and an index for test quality. In the parlance of ANOVA it would be called the intra-class correlation (see <span class="citation">Snijders and Bosker (2011)</span>, 3.5).</p>
</div>
<div class="section level2">
<h2 id="numerical-integration">Numerical Integration<a class="anchor" aria-label="anchor" href="#numerical-integration"></a>
</h2>
<p>CTT is a sometimes called a weak theory of measurement as it based on one assumption only, to wit, the test-score is random. Ability was introduced as a random variable to represent the test taker and could be continuous or discrete, uni- or multivariate. Assuming an IRT model like the Rasch model makes the theory stronger. The down-side is that the conclusions depend on the fit of the model. The advantage is that it allows us to do more. We mention one possibility.</p>
<p>Using IRT, reliability can be calculated using numerical or Monte-Carlo integration. Here is a small script based on Gauss-Hermite Quadrature which is the default procedure when the ability distribution is normal; see e.g., <span class="citation">Kolen, Zeng, and Hanson (1996)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">statmod</span><span class="op">)</span>
<span class="va">GH</span> <span class="op">=</span> <span class="fu">gauss.quad.prob</span><span class="op">(</span><span class="fl">60</span>,<span class="st">'normal'</span>,mu<span class="op">=</span><span class="fl">0</span>,sigma<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">x</span> <span class="op">=</span> <span class="va">GH</span><span class="op">$</span><span class="va">nodes</span>
<span class="va">w</span> <span class="op">=</span> <span class="va">GH</span><span class="op">$</span><span class="va">weights</span>

<span class="va">es</span> <span class="op">=</span> <span class="fu"><a href="../../reference/information.html">expected_score</a></span><span class="op">(</span><span class="va">parms</span><span class="op">)</span>
<span class="va">info</span> <span class="op">=</span> <span class="fu"><a href="../../reference/information.html">information</a></span><span class="op">(</span><span class="va">parms</span><span class="op">)</span>

<span class="va">expected.score</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">es</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="va">w</span><span class="op">)</span>

<span class="va">true.variance</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">es</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">w</span><span class="op">)</span> <span class="op">-</span> <span class="va">expected.score</span><span class="op">^</span><span class="fl">2</span>

<span class="va">error.variance</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">info</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="va">w</span><span class="op">)</span></code></pre></div>
<p>Assuming a standard normal ability distribution we find: <strong>true.variance = </strong> 39.04. The (average) error variance is just the expected information; in this case equal to <strong>error.variance = </strong> 6.2. The reliability is found to be <strong>true.variance/(error.variance+true.variance)) = </strong> 0.86.</p>
</div>
<div class="section level2">
<h2 id="the-consistency-of-classifications">The Consistency of Classifications<a class="anchor" aria-label="anchor" href="#the-consistency-of-classifications"></a>
</h2>
<p>Now for something new. Consider an examination that students fail if their test score is below a pass-fail score <span class="math inline">\(c\)</span>, and pass otherwise. Let us consider the probability that a person with the same ability obtains the same result over two exchangeable replications. Let <span class="math inline">\(I=(X_+\geq c)\)</span> be an indicator of passing. Then, the probability of a consistent outcome over two exchangeable replications of the exam is: <span class="math display">\[\begin{align*}
p(\text{Consistent}|\theta) &amp;= p(I=1,I^*=1|\theta) + p(I=0,I^*=0|\theta) \\
&amp;=\left(\sum_{s\geq c} p(X_+ =s|\theta)\right)^2 + \left(\sum_{s&lt; c} p(X_+ =s|\theta)\right)^2
\end{align*}\]</span> In our 2003 article, we have coined this the <strong>test-characteristic decision function</strong>. Here is an R-function that calculates this function using the function <strong>p_score</strong> which calculates the test score distribution given ability.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">TCDF</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">parms</span>, <span class="va">c</span><span class="op">)</span>
<span class="op">{</span>
  <span class="kw">function</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>
  <span class="op">{</span>
    <span class="va">p.score</span> <span class="op">=</span> <span class="fu"><a href="../../reference/information.html">p_score</a></span><span class="op">(</span><span class="va">parms</span><span class="op">)</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>
    <span class="va">s</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">p.score</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>
    
    <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">p.score</span><span class="op">[</span>,<span class="va">s</span><span class="op">&lt;</span><span class="va">c</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">p.score</span><span class="op">[</span>,<span class="va">s</span><span class="op">&gt;=</span><span class="va">c</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p>If, for illustration, we consider the verbal aggression test as an examination with a pass-fail-score of 20, we obtain the following picture.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">TCDF</span><span class="op">(</span><span class="va">parms</span>,<span class="fl">20</span><span class="op">)</span>, from<span class="op">=</span><span class="op">-</span><span class="fl">4</span>, to<span class="op">=</span><span class="fl">4</span>, xlab<span class="op">=</span><span class="st">'theta'</span>,ylab<span class="op">=</span><span class="st">'P(consistent)'</span><span class="op">)</span></code></pre></div>
<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-6" alt="plot of chunk unnamed-chunk-6" style="display: block; margin: auto;"></p>
<p>When the TCDC is integrated over the population that took the test (we estimated mu=-0.8, sigma=1), we obtain the probability of consistent classification when the test is applied to this population using c as a cutoff. For the verbal aggression test with a pass-fail score of 20 this percentage is 0.87 - not bad. The following function can be used for this.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Cons_class</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">parms</span>, <span class="va">c</span>, <span class="va">mu</span><span class="op">=</span><span class="fl">0</span>, <span class="va">sigma</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="op">{</span>
  <span class="va">GH</span> <span class="op">=</span> <span class="fu">gauss.quad.prob</span><span class="op">(</span><span class="fl">60</span>,<span class="st">'normal'</span>,mu<span class="op">=</span><span class="va">mu</span>, sigma<span class="op">=</span><span class="va">sigma</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">TCDF</span><span class="op">(</span><span class="va">parms</span>, <span class="va">c</span><span class="op">)</span><span class="op">(</span><span class="va">GH</span><span class="op">$</span><span class="va">nodes</span><span class="op">)</span> <span class="op">*</span> <span class="va">GH</span><span class="op">$</span><span class="va">weights</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>In closing: Integration requires that the values of the item parameters and the ability distribution are known to us. In a future blog we will discuss how plausible values may come to the rescue when that the IRT model is not fully known.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-BechgerMarisVerstralen2003">
<p>Bechger, Timo M., Gunter Maris, Huub H. F. M. Verstralen, and Anton A. Béguin. 2003. “Using Classical Test Theory in Combination with Item Response Theory.” <em>Applied Psychological Measurement</em> 27 (5): 319–34.</p>
</div>
<div id="ref-kolen1996conditional">
<p>Kolen, Michael J, Lingjia Zeng, and Bradley A Hanson. 1996. “Conditional Standard Errors of Measurement for Scale Scores Using Irt.” <em>Journal of Educational Measurement</em> 33 (2): 129–40.</p>
</div>
<div id="ref-snijders2011multilevel">
<p>Snijders, Tom AB, and Roel J Bosker. 2011. <em>Multilevel Analysis: An Introduction to Basic and Advanced Multilevel Modeling</em>. sage.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Gunter Maris, Timo Bechger, Jesse Koops, Ivailo Partchev.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
