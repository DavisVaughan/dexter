---
title: "Classical Test Theory with IRT"
author: "Timo Bechger and Jesse Koops"
date: "2022-02-03"
bibliography: dexter.bib
editor_options: 
  chunk_output_type: console
---



There is a long-standing interest in combining item response theory (IRT) and classical test theory (CTT) rather than treat them as mere alternatives [@BechgerMarisVerstralen2003]. The __theta functions__ in dexter are particularly helpful in this approach:

- __expected_score__: The expected score given theta.
- __information__: The Fisher information about theta in the test score.
- __p_score__: The distribution of test scores given theta.

where theta, i.e., $\theta$, represents student ability. The aim of this blog is to illustrate the use of these functions but we commence with a (very) brief overview of CTT. 

# Classical test theory

The test score is assumed to be a discrete random variable $X_+$ where the randomness is due to measurement error. The expected score of a test taker with ability $\theta$, $\mathcal{E}[X_+|\theta]$ is called the *true score*. It may be interpreted as the average score over (hypothetical) repeated testing of the same individual or as the average score of people with the same ability. 

The true score is a function of ability and, in IRT parlance, would be called the **test characteristic function (TCF)**. Obviously, the TCF cannot be observed but, if we assume a Rasch model, we can draw its curve using the function __expected_score__, the test score being the number of correct answers. 


```r
parms = data.frame(item_id=1:30, item_score=1, beta=rep(0,30))
Exp_sc = expected_score(parms)
plot(Exp_sc, from=-5,to=5, xlab="ability", ylab="Exp. score")
```

<img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-1" alt="plot of chunk unnamed-chunk-1" style="display: block; margin: auto;" />

The observed scores vary around their average due to __measurement error__, formally defined as deviations around the true score; $x_+ - \mathcal{E}[X_+|\theta]$. As we can always write $x_+ = \mathcal{E}[X_+|\theta] + \left(x_+ - \mathcal{E}[X_+|\theta]\right)$, we arrive at the famous equation:
$$
\text{observed score} = \text{true score} + \text{measurement error}
$$
which is merely a tautology, equivalent to a random-effects ANOVA model.

The amount of measurement error at a given level of ability is captured by the __conditional error variance (CEV)__: 
\begin{equation}
Var(X_+|\theta)=\mathcal{E}[\left(X_+ - \mathcal{E}[X_+|\theta] \right)^2|\theta]
\end{equation}
Like the true score, the CEV is a function of ability. Here is a plot.


```r
Cond.error.variance = information(parms)
curve(Cond.error.variance, from=-5,to=5, col="blue", xlab="ability")
```

<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAIAAACb4TnXAAAACXBIWXMAAAsSAAALEgHS3X78AAAgAElEQVR4nO3dfVyN9/8H8Fe3pFOqg+QuCbnt62ZChTSy1NINpeSmGjX1la9mfUc225h2x9zN2BcbkxHdY+5q87XWwkzF8hBbRYXuqKTb8/vjfPWrXCzO+VzXuXk//zpdj9P1eR3ttes61/mcz6UhkUhACGFDU+gAhKgyKhghDFHBCGGICkYIQ1QwQhiighHCEBWMEIaoYIQwRAUjhCEqGCEMUcEIYYgKRghDVDBCGKKCEcIQFYwQhqhghDBEBSOEISoYIQxRwQhhiApGCENUMEIYooIRwhAVjBCGqGCEMEQFI4QhKhghDFHBCGGICkYIQ1QwQhiighHCEBWMEIaoYIQwRAUjhCEqGCEMUcEIYYgKRghDVDBCGKKCEcIQFYwQhqhghDBEBSOEISoYIQxRwQhhiApGCENUMEIYooIRwhAVjBCGqGCEMEQFI4QhKhghDFHBCGGICkYIQ1QwQhiighHCEBWMEIaoYIQwRAUjhCFtoQO8mNLS0rS0NKFTEJWiqanp5uamo6PDYudKVrDU1NTExMQpU6YIHYSojn379o0aNcrS0pLFzpWsYADs7OyWLFkidAqiOjIzM9ntnN6DEcIQFYwQhqhghDCkfO/ByN+6ehU//4z8fAwdiilT0Lev0IHUGB3BVEpJCRYuxPr16NIFzs6oqUFQEN59F7W1QidTV3QEUx3XryMgAB9/jEmT/rfF3h5LluDAAbi4IC4ORkaC5lNLVDAVkZuLwEDExKB//zbbNTTg748+feDujvh4GBsLE09t0SmiKqiuRlAQDh5s364WDg54910EBUEi4TUYoYKpgtBQvP02zM2f9xxHR4wahc2b+cpEAFDBVEBMDMRizJr198+MisIPPyA7m30m8gQVTLlVVWHLFnz4YYeerKmJbdvwr3/RiSJ/qGDK7YMP8NZb0Nfv6PMHDsQrr+DwYZaZSCtUMCV24wZycjB79ov9VlQUNm2iT8Z4QgVTYuvW4f33X/i3RCIsWoRduxgEIk+hgimrvDw8eAAbm5f53aAgfP89HcT48LyC1dbWSujtsKL68EOsWvWSv6ujg4UL6SDGh/YFq6+v37Fjx6uvvmpgYGBqaqqnp2dtbR0ZGVlSUiJIPsLpr79QXv6Shy+pwEB8/z0aGuSXiXBpU7B9+/bNmDGjpqZm3bp1f/3118OHD8vLy7/77jtra+uAgIB33nnn4cOHQgUlrW3ZguXLZdqDri7c3elyInNt5iLq6+ufOXNGS0urZUuXLl2sra2tra3nzZv322+/3bt3z9DQkPeQpI2qKmRm4vPPZd3PkiVwd8e8efLIRJ6hzRHMy8tLS0srJSWl3ZP2798PYMyYMQMHDuQvGnmG3bsRGAgNDVn3Y2yMESNw/rw8MpFn4LjI8d57782ePfvOnTsAsrKyJk2atG3bNt6DEW4SCQ4fhp+ffPa2bBm2bpXPrggnjoJduHDB0dHRzs5u7ty5M2fODAoKysjI4D8Z4XTmDCZNQufO8tmblRUqK1FcLJ+9kadxFExTU9PY2FgikZSWlpqYmAwcOFBD9tMRIif/+Q+CguS5w4AA7Nsnzx2S1ji+cOng4NDU1HTs2LERI0acO3cuODh43Lhx33zzDe/ZSHulpaiqwuDB8tynpyemTMHKldCkSQcMcPyjLly48Ny5cyNGjAAwefLky5cv07UNBbF7NxYskPM+dXVhbw9aj5yRNgVLTU0FEBAQ0PqcUFdXNyoqCkBeXl5+fj7P+UhrSUnw8JD/bt94A3v2yH+3BO0Klp2d7eTktHfv3uvXrzc0NACQSCS3b98+ceLEnDlzNm7cKBKJBMpJkJGB0aPRqZP892xlhaIiPHgg/z2TNgULDw+Pi4srKiqaO3euvr6+ubm5vr7+xIkT4+Pjo6Ojv/zyS7FYLFRQsm+f/M8PW8yZg6NHWe1cnbW/yCESiVavXr169er6+vrS0lJDQ0M6aimC+nr8/rtMkw+fb+5c+PoiMJDV/tXWM68c1dXVaWhoULsURHIy3NwY7t/EBIaGuHWL4RDqiaNg5eXlbm5uRkZGTk5O6enpjo6O8r22UVFRUVVVJccdqoMDB+Q2e+NZ/P1x4ADbIdQQR8FCQkKsrKwKCwsB2NjY2NraLl68WJYx8vPz/f39CwsL8/PzbW1txWKxkZGRo6Pj7du3Zdmt+qisRHU1+vVjO4qzM374ge0QaoijYOfOnYuOju7VqxcAbW3tNWvWXLx4UZYxfH19LS0tzczMli1bZm9vf+fOndu3b48bNy4kJESW3aqPI0fg6cl8FF1dDBuG339nPpBa4ZjJYWpq+ssvv9jb20t/vHTpkpmZmSxj5Obm/vjjj9ra2llZWQcOHJC+r9uwYYOpqelzfuvo0aNfffVVu415eXlWVlZLly6VJY/SiY3F/v18DOTri4MHMWoUH2OpC8lT0tLSunbt6uTk1K1bt8WLF5uamiYnJz/9tI5zdnaOiYmRSCR+fn5Hjx6Vbjxx4sSoUaNedFfLly/38fGRJYzSKSqSvP46T2M1NUkmTJA0NfE0nIIICgrKy8tjtHPuuYh5eXlJSUm2trampqZr1qzpK9sdpr7++mtnZ+fPP/+8Z8+eXl5eY8aMaW5uLi4uTkpKkmW3aiI2Ft7ePI2lqYkJE5CejienL0RWHAV7/Pjxt99+O3HixMDAwCNHjsTGxoaFhenq6r70GL17975y5cpPP/1048aNyZMnd+3atX///q+++qq2Nt3b5e8lJCAhgb/hvL3x/fdUMLnh+E88PDw8KyvL2dkZgIWFxebNm69evbp7925ZhtHQ0HBwcHBwcJBlJ2ro9m0YG4PPVRomTMCKFWhqQquFI8jL4yhYQkJCdnZ2jx49AIwdOzY+Pn7o0KG8ByMAcPjwCy/cKyMNDdjZ4eefMXkyr+OqKo7L9AYGBhUVFS0/PnjwoGvXrjxGIv8vORkuLnwP6u2N2Fi+B1VVHEewDz74wMHBYd68ef369SsqKtq/f/+6dev4T0YKCiAW83p+KDVuHMLD6SxRPjiOYH5+fmfPnhWJRNnZ2dra2ikpKQEBAfwnI7GxmDNHgHE1NDBpEq02JR/c1/GGDRu2du1afpOQ9o4dQ2KiMEN7eeHAAUyZIszoqoSjYKmpqe+9915lZWXrjdl0X0R+3bkDY2MYGAgzuo0NwsPR3EwLdciKo2CrVq1ydXX19PTUonNw4fAz//BZNDRga4tffoGdnWAZVANHwW7durV69Wpaqk1YKSk4ckTIAF5eOHqUCiYrjjOAadOmbd26tbq6mv80RKqkBF26QNgPRyZOREYG3c1ZVhwFKygoCA8PF4vFQ4YMGfoE/8nUWXw8k9WjXoimJsaMgWxfVCJcp4g7d+7kPwdpLSlJIb5cLD1LHDdO6BzKjKNgw4cPb7clPj7+6Y2EkbIyaGrCxEToHMDkyYiKEjqEkuMo2PXr1zdu3Nhyr736+vr09HQPwU9Z1EZiItv1bTpOSwvDhiErC9bWQkdRWhzvwRYsWKClpdWtW7e7d+/OnDnz3r17n8t+szfSYfHxilIwPDlLJC+No2DXrl3btGnT2rVra2pq5s+fn5ycvGPHDv6TqaeHD1FXB9mWaJAnR0ekpgodQplxFEwsFufl5YnF4qKiorKyMn19/Rs3bvCfTD2lpMDVVegQrejqwsICublC51BaHAVbsWLFK6+8cu/ePR8fHycnp9dee23kyJH8J1NPcXFwdxc6RFteXoiPFzqE0uIo2LJly/744w8jI6Po6Oi33nrLw8PjiLBzCtTGo0eoqGC+/uGLmjEDp04JHUJpcc+m79+/v/SBr68vf1nU3okTmDFD6BBP6dwZ3bvj1i0MGCB0FCXUpmDjxo3bvn17aGjo08+7cOECX5HUV3w8FPNLQl5eSEzEv/4ldA4l1KZg27ZtGzJkyNPLfRIe1NWhsBCKeS9RFxe4u1PBXkabgo0fP76uri44ODgjI4PWVOPZ6dOYNk3oEM8gEsHAALdvo08foaMom/YXOTp16jRjxowvvvhCQvOo+XX0KN8LSL0QT09el2dUGRxXEdPT09euXSsWi4cPHz7yCf6TqZWGBly/DkX+0sLrryMlRegQSojjPPCLL77gP4eaS01V3PNDKSMj6Ojg3j306CF0FKXCUbB//OMf7bbEx8c/vZHIUVwc3nxT6BB/x90dCQlYskToHEqFZtMLr6kJV68qwU2DPD3h708FezE0m154aWnKsUCasTEA3LsndA6lQrPphSfUAqMvwcNDsKUalRTNphdYUxOyspTg/FDKw4Mu1r8Yjvdg0tn0+fn50tn0RkZGdJmenZ9+ghLd1EkshkSCsjKIxUJHURLCzKb/5Zdf5LtD5cX/DYpk5OGBuDihQygPjoL5+vpmZWUB0NbW9vX1DQsLk/vti5ycnOS7QyXV2IisLIwdK3SOFzF7Nn097AVwFGzUqFEbNmwwMzMLCgo6c+ZMU1OTjGMsX75cr63q6mrpAxn3rOzOnsWrrwod4gUZG0NTE3fvCp1DSXC8B4uMjIyMjCwpKUlOTt60aVNQUJCbm9vWrVtfeoyPPvqotrb26tWrO3bskN44c8CAAbdu3Xr+b/30008nTpxot/H8+fNiFTr9P3RIKaeoS1fCWbpU6BzK4JlT5k1MTCwsLAYPHpyTk3P69GlZxujSpcvOnTuTkpL8/Pyio6NdXFw0NTVNTU2f/1vDhw8XiUTtNhYUFNTV1ckSRnE0NCA3F8p4/cjDA97eVLAO4SjY3r17jx07dvr0aSsrKw8Pjx9++EEuS2e7ubnZ2NgEBAQkJyd35PndunXr1q1bu42mpqbFxcWyh1EEJ09CSd+KGhmhSxfcuYPevYWOovA43oPFxMRMnTr12rVrmZmZ77zzjhwXpu/Zs+fx48dHjhzprmgLuwghJgbKuyCDtzcOHRI6hDLgKNjp06dDQ0N7P/m/U2Vl5cmTJ+U1noaGRmho6P79++W1QyX16BGKimBlJXSOl+XujqQkoUMog7+/geG1a9fogCN3CQl4/XWhQ8igSxf06oXr14XOofDaF6yuru6VV15pbGxs2WJra1tbW8tvKtV36BB8fIQOIRtfX3z/vdAhFB4tGSCA8nI8fqz061vQeokdwXEVMT09/cKFCx999JGZmZnmk5tg003Q5ejwYXh7Cx1CZrq6sLbGxYt45RWhoygwWjJAALGxKnLLkvnzsX8/Fex5nrlkgEQiKS8vNzY2bjmIEbm4eRPdu8PISOgc8mBri7ffRkMDdHSEjqKoOMpz//59Pz8/PT29Pn366Onp+fj43L9/n/9kqmr/fvj7Cx1CfqZNg/w+xFFBHAULDg42NDQsKCiora0tKioSi8UhISH8J1NJEglOnVLEBehfmvQskTwLxyniuXPnioqKdHV1AYjF4s2bN/emKTFy8t//Yvx4lTqhsrREWRlKS/HUtDYCcB7BTExMpN8Hk8rJyTGWLndCZLZ3LxYtEjqEvPn50bSpZ+I4gq1fv97JycnT07Nfv36FhYVxcXG06I1c1NTgzz+hegtMenvj9dfBdU8ewnUEmzNnTmZm5tChQ6uqqoYMGZKRkeGtAp/aKIBDh5RsdYAOEonQvz+uXBE6h0JqfwSrq6uzs7PLyMiIiIgQJJAKO3hQZU+lAgKwdy/oA9Sn0VQpnuTmwtQUJiZC52Bj8mRcuoTHj4XOoXhoqhRPdu3C4sVCh2DJ3R1Hj2LePKFzKBiaKsWHujpkZkK1FyBftAh+flSw9jjegwUFBdEdLuXryBF4eEBDQ+gcLInFEItx7RqGDRM6iiKh92B8+OYbLFwodAj2goOxa5fQIRQMvQdj7soV9O6tFhMdpkzBqlWoqoKBgdBRFAa9B2Nu2zY1+hDW3x8HDoDmrrZ45tdVqqqqqqurzczMeI+kUiorcfMmxo0TOgdf5s+HkxOCg1X8DWfHcczkKC8vd3NzMzIycnJySk9Pd3R0zM/P5z+Zati9WwUnHz6HSIRx4/DTT0LnUBgcBQsJCbGysiosLARgY2Nja2u7WLU/wWGmqQlHjqjC6gAvZPlyyLDOuqrh/rrKnTt3tLS0AGhra69Zs4ZOFF9ObCxcXdG5s9A5+GVhAQC5uRgyROgoCoDjCGZqatr6/l2XLl2igr2cXbsQHCx0CCEsX45t24QOoRg4CrZ582ZXV9cZM2aUlJQsWbLE09Pz448/5j+Zsjt/HlZWanF1/mmTJiEnB2VlQudQABwFc3BwyMvL8/HxCQsLGzNmzIULF1xdXflPpuw+/RQrVggdQjihoXQQA551+6Ju3boFBgZKH0vXpp+hSutIsJeVBZEIgwYJnUM4Xl7YsgUrVqj7h860Nj0T0dF46y2hQwhKUxMBAfj6a6FzCO3vC0Zr07+oGzdQU4PRo4XOITR/fxw+rO5fEqNFReVv3TqsWiV0CAWgq4sFC9T9INbmPVj37t2ffoaGhoa+vv6ff/7JVyTlduMGHj7E+PFC51AMixdjyhQEBaFLF6GjCKTNESwvLy8vLy8iImLMmDEJCQlXrlzZu3evjY1NZGSk7CNVVla22/LgwQPZd6to3n+fDl//T0cHCxeq9XdY2hSsa9euXbt2/eqrr44ePWpnZ9erVy9XV9fY2NhPPvlEljGys7OHDx9uYmJiaWmZmJgo3VhXV2ekGgu0t5KTg8eP1Whqb0cEBODwYVRXC51DIBzvwRobG6UTEaUKCgpa34/vJYSEhLi4uFRUVOzevTskJOTnn3/uyG/V19dXPKWurk6Rvwm6ejU++EDoEApGVxdhYfjsM6FzCITjc7CIiAhHR8fg4GALC4u//vpr586dK1eulGWMnJyckydPikQiBweHnTt3Ll68+EoHFtH74Ycfvvvuu3Ybf//9d3Nzc1nCsHPuHExN6QvzHHx9MXUqSkrQs6fQUfgn4ZKWlhYaGurl5fXPf/7zxx9/5HxOx1lbW586darlRx8fn9DQ0MePHz9r9OdYvny5j4+PjHlYaG6WTJ0quX1b6ByK6tQpyZtvCh3iGYKCgvLy8hjtnHsmh4ODg4ODg7w6HB0d7eHhYWdnd/DgQRMTk6+++mrGjBl2dnby2r8i2LcPDg6gm2Q8y/Tp2L4dV66o4Mrhz8dRsNTU1Pfee6/dRT9Z1uRwdnbOzc09f/58p06dABgZGZ0/fz4xMfHixYsvvU+FUl2NHTuQmip0DsX2+ecIC8OJE0Ln4BdHwVatWuXq6urp6Sn9Sphc9OnTZ+7cuS0/6ujozJ49e7aqrNS+bh1WrFDfj3o6yNIS1tY4ckQ1F+h/Fo6C3bp1a/Xq1Rq0qELHXL2Ky5exYYPQOZTBu+9i+nRMn46uXYWOwheOy/TTpk3bunVrtdp+cvEimpuxbBm2bKE1XjpEXx9RUVizRugcPOIoWEFBQXh4uFgsHjJkyNAn+E+mFHbtgqMjrKyEzqE8Zs5EcTEyMoTOwReOU8SdO3fyn0MZ/fUXYmJw5ozQOZTNli3w8sLZs9DTEzoKexwFGz58OACJRFJeXm5sbNyyuC9prbkZISHYtg26ukJHUTZmZggNRVSUit8NQ4qjPPfv3/fz89PT0+vTp4+enp6Pj8/9+/f5T6bgNm/G5MmwthY6h3KaNw8FBUhLEzoHexwFCw4ONjQ0LCgoqK2tLSoqEovFIbQUclu//YbjxyGP7xior127EBWF0lKhczDGvS5iUVGRrq4uALFYvHnz5t40Q6GVqiqEhSE2FvL7mFAdGRtjwwa88Qbi41X5GizHEczExCQrK6vlx5ycHGNjYx4jKTSJBG+8gagomhUlB5Mnw8YG0dFC52CJ4wi2fv16JycnT0/Pfv36FRYWxsXF7dixg/9kiunjjzFyJGbOFDqHqnjnHcydixMn4OwsdBQ2OAo2Z86c0aNHJyYmlpSUDBkyJCMjY5A6rz/WSkoKLl5EbKzQOVSIhga+/hozZ8LCQjWX2uaeTT9w4MCIiIiGhgYdHR2eAymsy5fx6ac4dkyV3zAIwtAQ330HX18kJqJHD6HTyFv792Dbt2/38fGRPt6zZ4+5ufnGjRubm5t5D6ZY/vwTS5fi4EGIREJHUUX9+2PTJsydq4IrC7Q5gn388cfffvvtpk2bpD/6+/ubmpqGh4dLJJKIiAgh4imEe/cwfz727EGvXkJHUV0TJuCdd+Dtjbg4lbofTZsj2M6dO/ft29eySra+vr67u/uhQ4d2qfGyQHfvwtMTW7eC5mOyNn06Fi6Enx/q6oSOIj9tCnb37t2RI0e2e8bo0aPv3LnDYyQFUlwMLy9s3kzL9PLExwc+PvD2Vp31gNsUbNCgQa0/AZO6fPmywq4zw1ReHry8sG0bxo4VOoo68fHBggXw8IBqrJrZpmBhYWGBgYHXr19v2fLHH38EBQUtXbqU92ACy8zEggXYvx+jRgkdRf14eeHtt/H667h9W+goMmtzkeONN954+PDh+PHjzc3NzczMiouLb926tWrVKnUrWEwM9uxBQoIKXjVWFlOnQiyGtzc2bsSECUKnkUH7z8FWrFixaNGi33777c8//zQ3Nx8zZkw3dbpJY309IiNRVYVjx9Cpk9Bp1Ju1NRIT4e8Pd3e8+abQaV4WxwfNJiYm06ZN4z+K4G7exOLF8PfHk3sPEoF1745jxxAVBV9f7NgBZVxqnb5MCQASCXbtQmAgtm2jdikWbW1ERyMwEM7OOH1a6DQvjgqG3Fy89hqKi3HmDC18raCmT8fx44iJwaJFSvYVMu65iGqishLr1uHaNWzerJozTVWJsTH27kVaGtzdMWcOli6FUsyTVdMj2KNH+PRTzJwJe3scP07tUhpTp+LHH6GlhcmTceAAFH+SrNoVrLISGzbg1VdhYoJz50C3d1c62toIC8OpU7h1C/b22LsX9fVCZ3o2NSpYdjZCQ+Hujn798N//IigI2mp9gqzcDAywZg1OnUJFBaZMwdq1CvqptOr/J1ZWhkOHcOQI+vXDkiWwtRU6EJEfkQgrViA8HCkpCA0FAF9fzJqlQCsuqmzBCguRkoLkZADw9kZCAgwNhc5E2NDSwqxZmDULRUX4/ns4O8PUFO7umDEDJiYCZ1OpglVU4Px5pKbi4kWYmcHFBfv3QywWOhbhS69eWLECK1YgP/9/s0Dq6mBvj6lTMX68MIc1FSnY8uW4eBHGxrC3h48PPvuM1lRTa+bmWLYMy5ahthbnz+PsWXz4IZqb4eWFsDBek/BdsKqqKpFIJPd7I0VGomdPWi2DtKen978bJgFoaEBFBd8B+LiKWFtb+9FHH1lZWXXu3NnQ0FBXV3fw4MEffPBBvfwur5qZUbvI39DREeDrEXwULDQ09MKFC3v27CkuLm5oaLh3796333577do1dfsWDFFDfJwiJicnFxQU6D15j2lsbDxx4kQbG5sBAwY857dSUlL27dvXbuOVK1csLCxYBSVE3vgoWN++fU+ePOnedtLEuXPnnv9NM0dHx2FPzb1Nll53J0RJaEgkEtZj/Prrr3PmzDEyMho2bJiBgUF1dXVubm5paWliYuKYMWNeaFcnT56MjIzs3r27XIJdvXq1traWtxugPXr0qAuPd0rnc7jm5ub6+vrOfK231tDQ0KtXr759+8plb4WFhampqb3YLMrHR8EANDU1paWl5efnl5WVGRsbW1paTpkyRUvoS+nLli1bvHjx0wtpMTJ16tQ0Hm+Jxedw2dnZX3/99ZYtW/gZ7ptvvgGwaNEifoaTBU+X6bW0tNTzW9JEzanRZF9C+EcFI4QhKhghDFHBCGFIRSb7vhxNTU3ertED0Ob3C558Dsfzv6Tg1587jqfL9IqpurpaX19f7jOPn6WqqsrAwICfsXgeTiKR1NTUiPi6e5p0Fquuri4/w8lCrQtGCGv0HowQhqhghDBEBSOEISoYIQxRwQhhiApGCENUMEIYooLh0aNHy5cv52GgEydOjBo1qmvXrvb29jk5OewGyszMHDt2bPfu3YOCgmpra9kNJMXb62qNt7+arCRqb8mSJZ07d2Y9SmFhob6+/smTJ6uqqlauXDls2DBGAzU2Nvbt2zcuLu7Ro0ezZs1av349o4GkeHtd7fDzV5OduhcsMTHRzs6Ohz/VwYMHnZycpI8rKys1NDQqKipYDHT69OmRI0dKH58/f37w4MEsRmnB2+tqjbe/muzUumDFxcUjRozIysri4U9VXV1dVlYmfZyWljZgwABGA/3nP//x8fGRPi4vL+/UqROjgaR4e10t+PyryU5934NJJJKAgIDo6OgevKxGqa+vb2JiAiApKcnX13fjxo2MBiorK2uZ42tgYFBXV1dVVcVoLPD4uqR4/qvJTr0Ktnv37kGDBg0aNCg2NvbLL780Nzd3cXHhZzgADx488PX1jYyMPHLkyKxZsxgNamxsXF1dLX1cVVWlra3NepI7P69Lioe/mpwJfQgVjL+/v0gkEolE0rXNRCJReno6u+Hq6+vHjx+/dOnS+vp6dqNIJJIzZ86MHj1a+jg9PX3QoEFMh+PtdUnx/FeTnfoWrEVJSQkPZ/OxsbFjx4593AqjgRobG3v37p2amtrY2Ojj4/P+++8zGkiKt9fVDj9/Ndmp1ymigC5dunTp0qXOrTx48IDFQFpaWomJiREREQMGDNDX1//3v//NYpQWvL0uJUVfuCSEITqCEcIQFYwQhqhghDBEBSOEISoYIQxRwQhhiApGCENUMEIYooIRwhAVjBCGqGCEMEQFI4QhKhghDFHBCGGICkYIQ1QwQhiighHCEBWMEIaoYIQwRAVTbgcOHJg/f367jb/++uu4ceMAXLlyZfTo0a23AFCmRQWVHxVMBQ0dOnT79u3P2nLq1CkhQqkpKpgy2bJli4WFhaGh4YQJE65fvy7dWF1dPXv2bLFYPHHixKtXrwK4ceNGaGho619s2eLm5tbY2Dhy5Mj6+vrAwMAvvvhC+oSoqKiIiAh+X41aoIIpjfz8/MjIyOTk5NRGBTEAAAIHSURBVPv3748ePXrTpk3S7QkJCX5+fiUlJc7OztLbPjxnJ0lJSdra2tnZ2bq6uq6ursePH5duT0xM9PT0ZP4a1A8VTGmYmZnl5+ePGDGipqZGR0enZX1PGxsbT09PHR2dVatWFRUV3bx5s4M7nD59ekZGRk1Nzc2bN0tLSydOnMgsu/rSFjoA6ShNTc1PPvnk8OHDPXv2FIlEpqam0u3m5ubSB9ra2v369bt7927nzp07skMDA4MJEyacPXv2xo0b7u7umpr0f1v5o39TpREbG5uWlnb58uXMzMyAgICW7QUFBdIHTU1Nd+7c6dOnT8f3KT1LTEhI8PLyknNcAoAKpkTKysqMjIwMDQ0fPHiwa9eu+vp66fZff/01OTm5ubn5k08+sbS0bDmgPUddXZ30gYuLS1xcXG5uroODA7vk6owKpjTmz5+vqanZt29fV1fXN998Mz09PT4+HoCLi8tnn33Wo0ePkydPxsTE/O1+XF1dBw4cKO2npaWlWCx2cXHR1qY3C0zQzR/U3aRJk1auXOnm5iZ0ENVEBVNfjY2N2dnZjo6OxcXFHbwuQl4UnSKqr5SUFBcXl08//ZTaxQ4dwQhhiI5ghDBEBSOEISoYIQxRwQhhiApGCENUMEIYooIRwhAVjBCGqGCEMEQFI4QhKhghDFHBCGGICkYIQ1QwQhiighHC0P8Br4i94/aiCxQAAAAASUVORK5CYII=" title="plot of chunk unnamed-chunk-2" alt="plot of chunk unnamed-chunk-2" style="display: block; margin: auto;" />

Note that the CEV coincides with [**test information**](https://dexterities.netlify.com/2018/11/05/test-and-item-information-functions-in-dexter/) which is counter-intuitive as "error" sounds negative and "information" positive. Moreover, it is not true in general, but only in exponential family IRT models. We will clarify this in a future blog where we explain the difference between estimating a true score or an ability.

What happens in a population of test-takers? Using the [law of total expectation](https://en.wikipedia.org/wiki/Law_of_total_expectation), we find that, in a population of test-takers, the average of the true scores $\mathcal{E}[\mathcal{E}[X_+|\theta]] = \mathcal{E}[X_+]$ is just the average of the scores, as measurement errors average to zero. The variance of the test score is the sum of true score variance and error variance. Specifically, from the [law of total variance](https://en.wikipedia.org/wiki/Law_of_total_variance) it follows that:
$$
Var(X_+)=Var(\mathcal{E}[X_+|\theta])+\mathcal{E}[Var(X_+|\theta)]
$$
where $Var(\mathcal{E}[X_+|\theta])$ is the true-score variance and
\begin{align*}
 \mathcal{E}[Var(X_+|\theta)] & \equiv \mathcal{E}(\mathcal{E}[(X_+-\mathcal{E}[X_+|\theta])^{2}|\theta])  \\
 &=\mathcal{E}[(X_+-\mathcal{E}[X_+|\theta])^{2}]
\end{align*}
is indeed the variance of the measurement errors, sometimes called __the average error variance__. In the population of test takers, measurement errors and true scores are uncorrelated but not necessarily independent. For one thing, we expect measurement error to be smaller for test takers whose true scores lie on the upper or lower end of the score range.

Last, but not least, the proportion true-score variance in the population is the __reliability__. That is,
$$
\operatorname{rel}(X_+)  
  \equiv\frac{\operatorname{Var}(\mathcal{E}[X_+|\theta])}{\operatorname{Var}(X_+)}
=1-\frac{\mathcal{E}[\operatorname{Var}(X_+|\theta)]}{\operatorname{Var}(\mathcal{E}[X_+|\theta])+\mathcal{E
}[Var(X_+|\theta)]}
$$
defined if $\operatorname{Var}(X_+)>0$. Note that, since $Var(X_+) \geq Var(\mathcal{E}[X_+|\theta])$, $0\leq \operatorname{rel}(X_+)\leq 1$. Reliability is the correlation between two administrations of the same test to samples from the same population (see @BechgerMarisVerstralen2003) and is widely used as a measure of consistency and an index for test quality. In the parlance of ANOVA it would be called the intra-class correlation (see @snijders2011multilevel, 3.5).  

# Numerical Integration

CTT is sometimes called a weak theory of measurement as it based on one assumption only, namely that the test-score is random. Ability was introduced as a random variable to represent the test taker and could be continuous or discrete, uni- or multivariate. Assuming an IRT model like the Rasch model makes the theory stronger. The downside is that conclusions depend on the model fitting the data. The advantage is that it allows us to do more. We mention one possibility.

Using IRT, reliability can be calculated using numerical or Monte-Carlo integration. Here is a small script based on Gauss-Hermite Quadrature, which is the default procedure when the ability distribution is normal; see e.g., @kolen1996conditional. 


```r
library(statmod)
GH = gauss.quad.prob(60,'normal',mu=0,sigma=1)
x = GH$nodes
w = GH$weights

es = expected_score(parms)
info = information(parms)

expected.score = sum(es(x) * w)

true.variance = sum(es(x)^2 * w) - expected.score^2

error.variance = sum(info(x) * w)
```

Assuming a standard normal ability distribution we find: __true.variance = __ 39.04. The (average) error variance is just the expected information, in this case equal to  __error.variance = __ 6.2. The reliability is found to be __true.variance/(error.variance+true.variance)) = __ 0.86.




# The Consistency of Classifications

Now for something new. Consider an exam that students fail if their test score is below a pass-fail score $c$, and pass otherwise. Let us consider the probability that a person with the same ability obtains the same result over two exchangeable replications. Let $I=(X_+\geq c)$ be an indicator of passing. Then, the probability of a consistent outcome over two exchangeable replications of the exam is:
\begin{align*}
p(\text{Consistent}|\theta) &= p(I=1,I^*=1|\theta) + p(I=0,I^*=0|\theta) \\
&=\left(\sum_{s\geq c} p(X_+ =s|\theta)\right)^2 + \left(\sum_{s< c} p(X_+ =s|\theta)\right)^2
\end{align*}
In our 2003 article, we have called this the __test-characteristic decision function__. Here is how to compute this function using dexter's function __p_score__, which calculates the test score distribution given ability.



```r
TCDF = function(parms, c)
{
  function(theta)
  {
    p.score = p_score(parms)(theta)
    s = 1:ncol(p.score) - 1
    
    rowSums(p.score[,s<c])^2 + rowSums(p.score[,s>=c])^2
  }
}
```

As a somewhat ludicrous illustration, consider the verbal aggression test as an examination: everybody with a score of 20 or more gets official recognition as a verbally aggressive person. We obtain:



```r
plot(TCDF(parms,20), from=-4, to=4, xlab='theta',ylab='P(consistent)')
```

<img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-6" alt="plot of chunk unnamed-chunk-6" style="display: block; margin: auto;" />




Integrating the TCDC over the population that took the test (we have estimated that a normal distribution with mu=-0.8 and sigma=1 is a good choice), we obtain the probability of consistent classification when the test is applied to this population using `c` as a cutoff. For the verbal aggression test with a pass-fail score of 20 this is 0.87 -- not a bad result. The following function performs the computation:


```r
Cons_class = function(parms, c, mu=0, sigma=1)
{
  GH = gauss.quad.prob(60,'normal',mu=mu, sigma=sigma)
  sum(TCDF(parms, c)(GH$nodes) * GH$weights)
}
```

In closing: Integration requires that the values of the item parameters and the ability distribution are known to us. In a future blog we will discuss how plausible values may come to the rescue when the IRT model is not fully known.




# References
